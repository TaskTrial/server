model Task {
  id          String       @id @default(uuid()) @db.Uuid
  title       String       @db.VarChar(200)
  description String?      @db.Text
  priority    TaskPriority
  status      TaskStatus
  rate        Float?
  projectId   String       @db.Uuid
  sprintId    String?      @db.Uuid
  createdBy   String       @db.Uuid
  assignedTo  String?      @db.Uuid
  dueDate     DateTime
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  deletedAt   DateTime?

  // Relations
  project      Project          @relation(fields: [projectId], references: [id], onDelete: Cascade)
  sprint       Sprint?          @relation(fields: [sprintId], references: [id])
  creator      User             @relation("TaskCreator", fields: [createdBy], references: [id])
  assignee     User?            @relation("TaskAssignee", fields: [assignedTo], references: [id])
  attachments  TaskAttachment[]
  comments     Comment[]
  timelogs     Timelog[]
  dependencies TaskDependency[] @relation("DependentTask")
  dependentOn  TaskDependency[] @relation("MainTask")

  @@map("tasks")
  @@index([projectId])
  @@index([sprintId])
  @@index([createdBy])
  @@index([assignedTo])
}

model TaskAttachment {
  id         String   @id @default(uuid()) @db.Uuid
  taskId     String   @db.Uuid
  fileName   String   @db.VarChar(255)
  fileType   String   @db.VarChar(50)
  filePath   String
  fileSize   Int
  uploadedBy String   @db.Uuid
  createdAt  DateTime @default(now())

  // Relations
  task     Task @relation(fields: [taskId], references: [id], onDelete: Cascade)
  uploader User @relation(fields: [uploadedBy], references: [id])

  @@map("task_attachments")
  @@index([taskId])
  @@index([uploadedBy])
}

model TaskDependency {
  id              String         @id @default(uuid()) @db.Uuid
  taskId          String         @db.Uuid
  dependentTaskId String         @db.Uuid
  dependencyType  DependencyType

  // Relations
  task          Task @relation("MainTask", fields: [taskId], references: [id], onDelete: Cascade)
  dependentTask Task @relation("DependentTask", fields: [dependentTaskId], references: [id], onDelete: Cascade)

  @@map("task_dependencies")
  @@index([taskId])
  @@index([dependentTaskId])
}